	private Set<IFile> getSelectedFiles(ExecutionEvent event)
			throws ExecutionException {
		Set<IFile> preselectionCandidates = new LinkedHashSet<IFile>();
		IResource[] selectedResources = getSelectedResources(event);
		for (IFile file : files) {
			for (IResource resource : selectedResources) {
				if (resource.contains(file)) {
					preselectionCandidates.add(file);
					break;
				}
			}
		}
		return preselectionCandidates;
	}

